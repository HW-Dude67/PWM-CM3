Version 4
SHEET 1 6372 4964
WIRE 2976 864 2912 864
WIRE 3040 864 2976 864
WIRE 2912 896 2912 864
WIRE 2912 992 2912 976
WIRE 864 1408 688 1408
WIRE 1024 1408 864 1408
WIRE 1200 1408 1024 1408
WIRE 1584 1408 1488 1408
WIRE 1744 1408 1584 1408
WIRE 1952 1408 1824 1408
WIRE 2352 1408 2032 1408
WIRE 2432 1408 2352 1408
WIRE 2544 1408 2432 1408
WIRE 2992 1408 2544 1408
WIRE 3024 1408 2992 1408
WIRE 2432 1440 2432 1408
WIRE 1200 1456 1088 1456
WIRE 688 1488 688 1408
WIRE 864 1536 864 1408
WIRE 2432 1552 2432 1504
WIRE 1392 1568 1392 1536
WIRE 2544 1648 2544 1408
WIRE 688 1664 688 1568
WIRE 2352 1680 2352 1408
WIRE 864 1712 864 1600
WIRE 1392 1712 1392 1648
WIRE 1392 1712 864 1712
WIRE 2992 1728 2992 1408
WIRE 2544 1776 2544 1728
WIRE 1776 1888 1712 1888
WIRE 2112 1888 1776 1888
WIRE 2352 1888 2352 1760
WIRE 2352 1888 2160 1888
WIRE 1088 1904 1088 1456
WIRE 1136 1904 1088 1904
WIRE 1232 1904 1136 1904
WIRE 2112 1920 2112 1888
WIRE 2160 1936 2160 1888
WIRE 2352 1952 2352 1888
WIRE 2112 2064 2112 2000
WIRE 864 2176 864 1712
WIRE 2160 2176 2160 1984
WIRE 2160 2176 864 2176
WIRE 2352 2176 2352 2032
WIRE 2352 2176 2160 2176
WIRE 2544 2176 2544 1840
WIRE 2544 2176 2352 2176
WIRE 2624 2176 2544 2176
WIRE 2992 2176 2992 1808
WIRE 2992 2176 2624 2176
WIRE 800 2512 576 2512
WIRE 1104 2512 800 2512
WIRE 1264 2512 1104 2512
WIRE 1792 2512 1648 2512
WIRE 2016 2512 1792 2512
WIRE 2448 2512 2096 2512
WIRE 2544 2512 2448 2512
WIRE 2688 2512 2544 2512
WIRE 3040 2512 2688 2512
WIRE 3072 2512 3040 2512
WIRE 2544 2544 2544 2512
WIRE 1264 2560 1120 2560
WIRE 576 2592 576 2512
WIRE 800 2640 800 2512
WIRE 2544 2656 2544 2608
WIRE 1408 2672 1408 2640
WIRE 2688 2720 2688 2512
WIRE 3040 2752 3040 2512
WIRE 576 2768 576 2672
WIRE 1120 2768 1120 2560
WIRE 1344 2768 1120 2768
WIRE 2448 2784 2448 2512
WIRE 2688 2848 2688 2800
WIRE 800 2864 800 2704
WIRE 1408 2864 1408 2752
WIRE 1408 2864 800 2864
WIRE 1792 3024 1728 3024
WIRE 2016 3024 1792 3024
WIRE 2208 3024 2096 3024
WIRE 2304 3024 2208 3024
WIRE 2448 3024 2448 2864
WIRE 2448 3024 2352 3024
WIRE 1120 3040 1120 2768
WIRE 1184 3040 1120 3040
WIRE 1248 3040 1184 3040
WIRE 2304 3056 2304 3024
WIRE 2448 3056 2448 3024
WIRE 2352 3072 2352 3024
WIRE 2304 3200 2304 3136
WIRE 800 3296 800 2864
WIRE 2352 3296 2352 3120
WIRE 2352 3296 800 3296
WIRE 2448 3296 2448 3136
WIRE 2448 3296 2352 3296
WIRE 2688 3296 2688 2912
WIRE 2688 3296 2448 3296
WIRE 2752 3296 2688 3296
WIRE 3040 3296 3040 2832
WIRE 3040 3296 2752 3296
FLAG 1024 1408 a
FLAG 2624 2176 out
FLAG 688 1664 0
FLAG 1136 1904 Vc
FLAG 1776 1888 Vi
FLAG 2432 1552 0
FLAG 2912 992 0
FLAG 2976 864 Rload
FLAG 2112 2064 0
FLAG 3024 1408 0
FLAG 1104 2512 CM3-a
FLAG 2752 3296 CM3-out
FLAG 576 2768 0
FLAG 1184 3040 CM3-Vc
FLAG 1792 3024 CM3-Vi
FLAG 2544 2656 0
FLAG 1792 2512 CM3-c
FLAG 2304 3200 0
FLAG 3072 2512 0
FLAG 2208 3024 CM3-Vo
FLAG 1584 1408 c
DATAFLAG 1264 2768 ""
DATAFLAG 2912 3296 ""
SYMBOL ind 1728 1424 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value {L}
SYMATTR SpiceLine Rser=1m
SYMBOL res 2048 1392 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1m
SYMBOL cap 2528 1776 R0
SYMATTR InstName Cout
SYMATTR Value 220µ
SYMBOL res 2976 1712 R0
SYMATTR InstName R11
SYMATTR Value R = V(Rload)
SYMBOL res 2336 1664 R0
SYMATTR InstName R12
SYMATTR Value {Rdiv1}
SYMBOL res 2336 1936 R0
SYMATTR InstName R13
SYMATTR Value {Rdiv2}
SYMBOL voltage 688 1472 R0
SYMATTR InstName V3
SYMATTR Value {Vin}
SYMBOL res 2528 1632 R0
SYMATTR InstName R15
SYMATTR Value {Cesr}
SYMBOL TransconErrorAmp 1616 1824 M0
WINDOW 0 380 -53 Right 2
WINDOW 39 897 384 Right 2
SYMATTR InstName X3
SYMATTR SpiceLine C_comp2 = {C_comp2}, C_comp = {C_comp}, R_comp = {R_comp}, Pos = 3, Neg = 0, Gain = {TA_Gain}, Vref = {Vref}
SYMBOL cap 2416 1440 R0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL voltage 2912 880 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 -72 51 Left 2
WINDOW 3 44 51 Left 2
SYMATTR InstName V1
SYMATTR Value PULSE({R_idle} {R_step} 2m 1u 1u 6m 16m)
SYMBOL res 1376 1552 R0
SYMATTR InstName R18
SYMATTR Value 1µ
SYMBOL IdealBuck 1296 1440 R0
WINDOW 0 -78 -114 Bottom 2
WINDOW 39 -94 -95 Left 2
SYMATTR InstName X1
SYMATTR SpiceLine L = {L}, Fs = {Fs}, Ri = {Ri} , SlopeAmp = {Se / Fs}, D_min = {clampL}, D_max = {clampH}
SYMBOL e 2112 1904 M0
SYMATTR InstName E2
SYMATTR Value 1
SYMBOL cap 848 1536 R0
SYMATTR InstName Cin
SYMATTR Value 220µ
SYMBOL res 2112 2496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 1m
SYMBOL cap 2672 2848 R0
SYMATTR InstName Cout1
SYMATTR Value 220µ
SYMBOL res 3024 2736 R0
SYMATTR InstName R3
SYMATTR Value R = V(Rload)
SYMBOL res 2432 2768 R0
SYMATTR InstName R4
SYMATTR Value {Rdiv1}
SYMBOL res 2432 3040 R0
SYMATTR InstName R5
SYMATTR Value {Rdiv2}
SYMBOL voltage 576 2576 R0
SYMATTR InstName V2
SYMATTR Value {Vin}
SYMBOL res 2672 2704 R0
SYMATTR InstName R8
SYMATTR Value {Cesr}
SYMBOL res 1392 2656 R0
SYMATTR InstName R9
SYMATTR Value 1µ
SYMBOL TransconErrorAmp 1632 2960 M0
WINDOW 0 380 -53 Right 2
WINDOW 39 794 231 Right 2
SYMATTR InstName X2
SYMATTR SpiceLine C_comp2 = {C_comp2}, C_comp = {C_comp}, R_comp = {R_comp}, Pos = 3, Neg = 0, Gain = {TA_Gain}, Vref = {Vref}
SYMBOL voltage 2000 3024 R270
WINDOW 0 115 -64 VRight 2
WINDOW 3 38 -70 VRight 2
WINDOW 123 75 -67 VRight 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value SINE(0)
SYMATTR Value2 AC {AC_amp} 0
SYMBOL cap 2528 2544 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL e 2304 3040 M0
SYMATTR InstName E3
SYMATTR Value 1
SYMBOL cap 784 2640 R0
SYMATTR InstName Cin1
SYMATTR Value 220µ
SYMBOL Buck_CM3 1344 2544 R0
WINDOW 0 -56 -107 Bottom 2
WINDOW 39 -73 -95 Left 2
SYMATTR InstName X4
SYMATTR SpiceLine sync = 0, L = {L}, Fs = {Fs}, Ri = {Ri} , SlopeAmp = {Se / Fs}, D_min = {clampL}, D_max = {clampH}
TEXT 1192 1104 Left 2 !.param clampL = 0.1
TEXT 1192 1128 Left 2 !.param clampH = 0.99
TEXT 2896 1184 Left 2 ;.ac oct 100 10 1meg
TEXT 1192 896 Left 2 !.param L = 37.5u
TEXT 1192 928 Left 2 !.param Fs = 50k
TEXT 1192 960 Left 2 !.param Ri = 0.33
TEXT 1192 1056 Left 2 !.param Se = {rAmp * Fs}
TEXT 1488 1056 Left 2 ;Compensation Ramp  - V/s
TEXT 1488 960 Left 2 ;R sense  - Ohms
TEXT 1488 928 Left 2 ;Switching Freq - Hz
TEXT 1488 896 Left 2 ;Inductance - H
TEXT 1488 1104 Left 2 ;Duty Cycle Limits
TEXT 1192 840 Left 4 ;PWM-CM Parameters
TEXT 1856 904 Left 2 !.param Vref = 2.5
TEXT 1856 936 Left 2 !.param TA_Gain = 135u
TEXT 1856 968 Left 2 !.param C_comp = 8n
TEXT 1856 1000 Left 2 !.param R_comp = 20k
TEXT 1768 1840 Left 2 !.ic V(Vi) = {Vref}
TEXT 2616 2120 Left 2 !.ic V(out) = {-1*Vout}
TEXT 1000 1928 Left 2 !.ic V(Vc) = 1.248
TEXT 2328 952 Left 2 !.param I_idle = { abs( Vout / 3 ) }
TEXT 2328 976 Left 2 !.param I_step = { abs( Vout / 30 ) }
TEXT 2328 920 Left 2 !.param Vout = 5
TEXT 2328 1088 Left 2 !.param R_idle = { Vout / I_idle}
TEXT 2328 1112 Left 2 !.param R_step = { Vout / I_step }
TEXT 2328 896 Left 2 !.param Vin = 6
TEXT 2328 1016 Left 2 !.param Rdiv2 = 10k
TEXT 2328 1040 Left 2 !.param Rdiv1 = Rdiv2 * (Vout - Vref) / Vref
TEXT 1192 1016 Left 2 !.param rAmp = 0.5m
TEXT 1864 848 Left 4 ;Error Amp Parameters
TEXT 2320 848 Left 4 ;Circuit Parameters
TEXT 3320 3160 Left 2 ;Drawn : Mark Dimattina
TEXT 3320 3112 Left 4 ;Title : BuckBoost_negOutput
TEXT 3320 3224 Left 2 ;Rev: 0.01
TEXT 3320 3192 Left 2 ;Date: 02/09/2017
TEXT 3320 3256 Left 2 ;M.J.Dimattina@ieee.org
TEXT 1744 1488 Left 2 !.ic I(L1) = I_idle
TEXT 2896 1208 Left 2 ;.step param Vout 5 7 2
TEXT 2896 1072 Left 2 !.param  AC_amp = 0.01
TEXT 2904 1128 Left 2 !.tran 0 12m 0
TEXT 2328 1160 Left 2 !.param Cesr = 1m
TEXT 1856 1040 Left 2 !.param C_comp2 = 200p
TEXT 1544 1528 Left 2 !.ic V(c) = 10m
RECTANGLE Normal 4016 3392 448 768 2
